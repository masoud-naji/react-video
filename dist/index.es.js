import e,{useRef as t,useState as n,useEffect as l}from"react";function r(e){for(var t="",n=e.split(/\n/);n.length>3;){for(var l=3;l<n.length;l++)n[2]+="\n"+n[l];n.splice(3,n.length-3)}var r=0;if(!n[0].match(/\d+:\d+:\d+/)&&n[1].match(/\d+:\d+:\d+/)&&(t+=n[0].match(/\w+/)+"\n",r+=1),!n[r].match(/\d+:\d+:\d+/))return"";var a=n[1].match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);return a?(t+=a[1]+":"+a[2]+":"+a[3]+"."+a[4]+" --\x3e "+a[5]+":"+a[6]+":"+a[7]+"."+a[8]+"\n",n[r+=1]&&(t+=n[r]+"\n\n"),t):""}function a(e){for(var t="",n=e.split(/\n/);n.length>3;){for(var l=3;l<n.length;l++)n[2]+="\n"+n[l];n.splice(3,n.length-3)}var r=0;if(!n[r].match(/\d+:\d+.\d+,\d+:\d+.\d+/))return"";var a=n[0].match(/(\d+:\d+:\d+.\d+),(\d+:\d+:\d+.\d+)/);return a?(t+=a[1]+" --\x3e "+a[2]+"\n",n[r+=1]&&(t+=n[r]+"\n\n"),t):""}const c=({videopath:c,autoplay:o,captionurl:s,embedurl:d,loop:i,muted:u,playPause:p,type:h,control:m})=>{const v=t(null),[g,f]=n(!0);return console.log(s),l((()=>{const e=v.current;if(e){if(e.addEventListener("play",(()=>{f(!1)})),e.addEventListener("pause",(()=>{f(!0)})),s&&s.toLowerCase().endsWith(".srt"))fetch(s).then((e=>e.text())).then((t=>{const n=function(e){var t=e.replace(/\r+/g,""),n=(t=t.replace(/^\s+|\s+$/g,"")).split("\n\n"),l="";if(n.length>0){l+="WEBVTT\n\n";for(var a=0;a<n.length;a++)l+=r(n[a])}return l}(t),l=new Blob([n],{type:"text/vtt"}),a=URL.createObjectURL(l);console.log("from srt",a);const c=document.createElement("track");c.kind="subtitles",c.label="English",c.srclang="en",c.src=a,e.appendChild(c)}));else if(s&&s.toLowerCase().endsWith(".sbv"))fetch(s).then((e=>e.text())).then((t=>{const n=function(e){var t=e.replace(/\r+/g,""),n=(t=t.replace(/^\s+|\s+$/g,"")).split("\n\n"),l="";if(n.length>0){l+="WEBVTT\n\n";for(var r=0;r<n.length;r++)l+=r+1+"\n",l+=a(n[r])}return l}(t),l=new Blob([n],{type:"text/vtt"}),r=URL.createObjectURL(l);console.log(r);const c=document.createElement("track");c.kind="subtitles",c.label="English",c.srclang="en",c.src=r,e.appendChild(c)}));else if(s&&s.toLowerCase().endsWith(".vtt")){const t=document.createElement("track");t.kind="subtitles",t.label="English",t.srclang="en",t.src=s,e.appendChild(t)}o&&e.play()}}),[c,o,s]),e.createElement("div",null,"Video Player here",e.createElement("br",null),h,"videoPath"===h?e.createElement("div",null,e.createElement("video",{ref:v,className:"video-js vjs-default-skin",style:{width:"100%",height:"100%"},controls:m,loop:i,muted:u,playsInline:!0,autoPlay:o,disablePictureInPicture:!0},e.createElement("source",{src:c,type:"video/mp4"}),e.createElement("source",{src:c,type:"video/webm"}),e.createElement("source",{src:c,type:"video/ogg"})),o&&i&&p&&!m&&e.createElement("div",{className:"cmp-video__autoplay-control"},e.createElement("button",{onClick:()=>g?v.current.play():v.current.pause(),className:`icon icon--${o?"pause":"play"}-button-white autoplay-control`,"aria-label":"click to pause video"}))):"thirdPartyEmbed"===h?e.createElement("div",{dangerouslySetInnerHTML:{__html:d}}):null,"End of video player")},o=t=>e.createElement(c,t);export{o as ReactVideoPlayer};
